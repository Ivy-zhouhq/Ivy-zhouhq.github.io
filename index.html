<!DOCTYPE html>


<html lang="en">


<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
     
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

  

</head>

</html>

<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">Hanqi ZHOU</a></h1>
      <div id="subtitle-box">
        
          <span id="subtitle">never ever compromise</span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>




<!-- Subtitle -->

<div id="main">
  <section class="outer">
  
  
<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content">The explanation of Bayes&#39; theorem is awesome. The important thing is the Bayesian way of thinking, not memorizing the formula.</div>
</div>


<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-shallow_GCN"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/09/01/shallow_GCN/"
    >First Encounter with GCN</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/09/01/shallow_GCN/" class="article-date">
  <time datetime="2020-09-01T15:50:55.000Z" itemprop="datePublished">2020-09-01</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/shallow-understanding/">shallow understanding</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="Intorduction"><a href="#Intorduction" class="headerlink" title="Intorduction"></a>Intorduction</h2><p>Graph Convolutional Network(GCN), has been very popular in the past two years and has made a lot of progress.</p>
<p>Recently, Professor Maosong Sun’s group of Tsinghua University published the paper Graph Neural Networks: A Review of Methods and Applications on arXiv. The author gave a detailed and comprehensive overview of the existing GNN models. GCN is an important branch of GNN.</p>
<h2 id="What-is-Convolution"><a href="#What-is-Convolution" class="headerlink" title="What is Convolution?"></a>What is Convolution?</h2><p>The mathematical definition of Convolution is:<br>$$<br>(f * g)(t)=\int_{\mathbb{R}} f(x) g(t-x) d x<br>$$<br>Generally called g is the filter or kernel acting on f<br>The one-dimensional convolution diagram is as follows:<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjqrco4cr7g30d004376b.gif"></p>
<p>The common CNN two-dimensional convolution diagram is as follows:<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjqrd8bnvkg30az0chq6a.gif"></p>
<p>The concept of convolution in an image is very straightforward, because the arrangement order of pixels has a clear up, down, left, and right positional relationship.</p>
<p><strong>How to do convolution in the abstract graph?</strong></p>
<h2 id="Fourier-Transform"><a href="#Fourier-Transform" class="headerlink" title="Fourier Transform"></a>Fourier Transform</h2><p>In order to solve the problem of convolution calculation on graph, we give the second equipment-Fourier transform.</p>
<p>First of all, according to the convolution theorem, the convolution formula can also be written as:<br>$$<br>f * g=\mathcal{F}^{-1}{\mathcal{F}{f} \cdot \mathcal{F}{g}}<br>$$<br>In this way, we only need to define the fourier transformation on the graph to define the convolution transformation on the graph.</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjqrfjkvkag30b408c786.gif"></p>
<p>Okay, let’s first look at the definition of Fourier transform:<br>$$<br>\mathcal{F}{f}(v)=\int_{\mathbb{R}} f(x) e^{-2 \pi i x \cdot v} d x<br>$$<br>The Inverse Fourier transform is:<br>$$<br>\mathcal{F}^{-1}{f}(x)=\int_{\mathbb{R}} f(v) e^{2 \pi i x \cdot v} d v<br>$$</p>
<p>According to the definition of Fourier transform and its inverse transform, let’s prove the <strong>convolution theorem</strong>.<br>$$<br>\begin{aligned}<br>h(z) &amp;=\int_{\mathbb{R}} f(x) g(z-x) d x \<br>\mathcal{F}{f * g}(v) &amp;=\mathcal{F}{h}(v) \<br>&amp;=\int_{\mathbb{R}} h(z) e^{-2 \pi i z \cdot v} d z \<br>&amp;=\int_{\mathbb{R}} \int_{\mathbb{R}} f(x) g(z-x) e^{-2 \pi i z \cdot v} d x d z \<br>&amp;=\int_{\mathbb{R}} f(x)\left(\int_{\mathbb{R}} g(z-x) e^{-2 \pi i z \cdot v} d z\right) d x<br>\end{aligned}<br>$$<br>where $y=z-x ; d y=d z$<br>$$<br>\begin{aligned}<br>\mathcal{F}{f * g}(v) &amp;=\int_{\mathbb{R}} f(x)\left(\int_{\mathbb{R}} g(y) e^{-2 \pi i(y+x) \cdot v} d y\right) d x \<br>&amp;=\int_{\mathbb{R}} f(x) e^{-2 \pi i x \cdot v}\left(\int_{\mathbb{R}} g(y) e^{-2 \pi i y \cdot v} d y\right) d x \<br>&amp;=\int_{\mathbb{R}} f(x) e^{-2 \pi i x \cdot v} d x \int_{\mathbb{R}} g(y) e^{-2 \pi i y \cdot v} d y \<br>&amp;=\mathcal{F}{f}(v) \cdot \mathcal{F}{g}(v)<br>\end{aligned}<br>$$<br>Finally, act $\mathcal{F}^{-1}$ on both sides of the equation at the same time to get</p>
<h2 id="Laplacian-Operator"><a href="#Laplacian-Operator" class="headerlink" title="Laplacian Operator"></a>Laplacian Operator</h2><p>After a wave of unrest, another unfamiliar concept came.<br>Don’t worry, this is the last piece of equipment before the <em>Novice Village</em>.<br>The first derivative is defined as:<br>$$<br>f^{\prime}(x)=\lim <em>{h \rightarrow 0} \frac{f(x+h)-f(x)}{h}<br>$$<br>The laplacian operator is simply the second derivative:<br>$$<br>\Delta f(x)=\lim <em>{h \rightarrow 0} \frac{f(x+h)-2 f(x)+f(x-h)}{h^{2}}<br>$$<br>On the graph, we can define the first derivative as:<br>$$<br>f</em>{* g}^{\prime}(x)=f(x)-f(y)<br>$$<br>Where y is the neighbor node of x<br>Then the corresponding Laplacian operator can be defined as:<br>$$<br>\Delta</em>{* g} f^{\prime}(x)=\Sigma_{y \sim x} f(x)-f(y)<br>$$<br>Define $D$ to be the degree matrix of $N \times N$<br>$$<br>D(i, j)=\left{\begin{array}{ll}<br>d_{i} &amp; \text { if } i=j \<br>0 &amp; \text { otherwise }<br>\end{array}\right.<br>$$<br>Defice $A$ to be the adjacency matrix of  $N \times N$<br>$$<br>A(i, j)=\left{\begin{array}{ll}<br>1 &amp; \text { if } x_{i} \sim x_{j} \<br>0 &amp; \text { otherwise }<br>\end{array}\right.<br>$$<br>Then the Laplacian operator on the graph can be written as<br>$$<br>L=D-A<br>$$<br>After standardization $L=I_{N}-D^{-\frac{1}{2}} A D^{-\frac{1}{2}}$</p>
<h2 id="Derive-Graph-Convolution"><a href="#Derive-Graph-Convolution" class="headerlink" title="Derive Graph Convolution"></a>Derive Graph Convolution</h2><p>Now that we have obtained all the equipment of Novice Village, we will start to derive the GCN formula below. Remember the convolution theorem we mentioned earlier?<br>$$<br>f * g=\mathcal{F}^{-1}{\mathcal{F}{f} \cdot \mathcal{F}{g}}<br>$$<br>Then the convolution formula of the graph can be expressed as:<br>$$<br>g * x=U\left(U^{T} g \cdot U^{T} x\right)<br>$$<br>As the filter function of graph convolution, we hope to have good locality. Just like the filter in the CNN model, it only affects pixels near one pixel. Then we can define as a function of laplacian matrix<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gju5ppjvdlg30fk0bon4f.gif"><br>Applying the laplacian matrix once is equivalent to spreading neighbor nodes on the graph once. Further we can regard $U^{T} g$ as a function of the laplacian eigenvalue of $g_{\theta}(\Lambda)$.<br>Rewriting the above graph convolution formula, we can get the formula (3) of the paper <a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1609.02907.pdf">SEMI-SUPERVISED CLASSIFICATION WITH GRAPH CONVOLUTIONAL NETWORKS</a><br>$$<br>g_{\theta} * x=U g_{\theta} U^{T} x=U g_{\theta^{\prime}}(\Lambda) U^{T} x<br>$$<br>It can be seen that the complexity of this convolution calculation is very high, involving finding the eigenvector of the laplacian matrix and a large number of matrix calculations. Below we consider approximating the filter function, the goal is to save the solution of the feature vector<br>$$<br>g_{\theta^{\prime}}(\Lambda) \approx \sum_{k=0}^{K} \theta_{k}^{\prime} T_{k}(\tilde{\Lambda})<br>$$<br>Where $T_{k}$ is the Chebyshev polynomial. Here, simple $g_{\theta}(\Lambda)$ can be simply regarded as a polynomial of $(\Lambda)$.<br>Because $U \Lambda^{k} U^{T}=\left(U \Lambda U^{T}\right)^{k}=L^{k}$, so the filter function above can be written as a function of L<br>$$<br>g_{\theta^{\prime}}(\Lambda) \approx \sum_{k=0}^{K} \theta_{k}^{\prime} T_{k}(\tilde{L})<br>$$<br>Set K=1 and the convolution formula can be simplified to<br>$$<br>\begin{aligned}<br>g_{\theta^{\prime}} * x &amp; \approx \theta\left(I_{N}+L\right) x \<br>&amp;=\theta\left(I_{N}+D^{-\frac{1}{2}} A D^{-\frac{1}{2}}\right) x<br>\end{aligned}<br>$$<br>Assume that $\tilde{A}=A+I_{N}, \quad \tilde{D}<em>{i i}=\sum</em>{j} \tilde{A}<em>{i j}$,<br>$$<br>g</em>{\theta^{\prime}} * x=\theta\left(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}}\right) x<br>$$<br>Then coupled with the activation layer, we can get the final GCN formula:<br>$$<br>H^{(l+1)}=\sigma\left(\tilde{D}^{-\frac{1}{2}} \tilde{A} \tilde{D}^{-\frac{1}{2}} H^{(l)} W^{(l)}\right)<br>$$</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/GCN/" rel="tag">GCN</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-shallow_bot3"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/08/27/shallow_bot3/"
    >Think about Bot 3</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/08/27/shallow_bot3/" class="article-date">
  <time datetime="2020-08-27T18:50:55.000Z" itemprop="datePublished">2020-08-27</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/shallow-understanding/">shallow understanding</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="Evaluation"><a href="#Evaluation" class="headerlink" title="Evaluation"></a>Evaluation</h2><p>It is difficult to evaluate bot response. Although it can be done with BLEU, the automatic evaluation method of machine translation, the effect will not be very good. Almost every paper will spend money to hire people to do manual evaluation, design a set of evaluation mechanism to score, manual evaluation is more convincing. This is especially true for practical engineering applications, and users say that it is really good. Rather than simply take the biased indicators you mentioned and compare them with several methods or other company bots to show you are good.</p>
<h2 id="Thinking"><a href="#Thinking" class="headerlink" title="Thinking"></a>Thinking</h2><p>After reading some papers and communicating with front-line engineers who are doing bot applications, I have a little thought, and the summary is as follows:</p>
<ol>
<li><p>Do you want to be a bot? There is a popular saying that there are no useful bots on the market. To solve the problem of bots requires a lot of technological progress at the same time, and it may take a very long time. Now it is ridiculous to use this thing for business. My personal view is that bots that solve specific tasks, combined with current advanced technology, and do some framework tools, are not so far away. Although it is not easy, it is very meaningful and solves the bot problem in the vertical field. It is possible to solve the bot problem of open domain. It is precisely because it is not easy to raise the threshold, there will be real opportunities to give birth to some great technology companies.</p>
</li>
<li><p>Is it open domain or task-oriented? If it were me, I would choose the latter, because the former is just a dream, an unattainable dream that requires more technological breakthroughs. Task-oriented is more specific and more practical. It provides some solutions for specific businesses. Many companies are already doing it. Although a universal or extensible solution has not yet appeared, it must be a trend and a new one. Opportunity for a generation of bot companies.</p>
</li>
<li><p>Why is task-oriented bot difficult, and in which direction should it be used? End-to-end is an idealized model. Deep learning models are used to “capture” some features and “fit” some functions from a large amount of training data. Although very good results can be obtained, it is indeed very convenient to use , But embarrassment is embarrassment. Mass data cannot be obtained in a specific task. After the data scale is small, pure end-to-end becomes very tasteless. However, in real scenarios, many companies have certain data and bot needs. So the mature solution is to design some features, templates and rules for your specific business. When the customer’s business changes, you need Constantly maintaining the existing bot system is very time-consuming and laborious. Real scenarios often involve a lot of structured business data. It is impossible to generate response directly based on context purely and violently. Articles [8][9] all give very enlightening solutions. Apply end-to-end locally, rather than the whole, with technologies such as Information Extraction and Knowledge Graph to achieve a highly available framework system. This should be the development direction of task-oriented bots.</p>
</li>
<li><p>What factors should be related to the generation of response? The quality of the response needs to be linked to these features: (1) user query, the user’s question, what exactly the user is asking in this round of dialogue, and accurately understanding the user’s intention is crucial. (2) user modeling, modeling the user, including the user’s basic information, and more importantly, the mining of the user history conversation logs. This job is difficult, but at the same time it is also very good. It is also a technology company that proves its technology A great way. The mining of logs is very common now, not everyone is doing well, and the logs here are not generally set and structured indicators, but unstructured text logs, which are more difficult to mine. Another point is also seen in paper. User emotion and sentiment analysis are tasks that are studied in nlp. The user’s emotion is directly related to the success or failure of sales. If the technology is good enough, there can be enough factors to consider. The analysis is clear enough. Hanging the history in the model is not a good way, because the history is constantly growing, which will cause problems when the model captures information. A better way may be to build a user profile and so on, to precipitate the history as a vector Representation, or a kind of knowledge graph to represent a user. A bot with this ability is a personalized bot. (3) Knowledge, external knowledge source. When it comes to specific business, business data is also a kind of knowledge. How to model knowledge into the model and be more professional and accurate when generating dialogue is also a very important issue. Bot is a comprehensive problem, not only the difficulty of the system framework, but also the difficulty of modeling.</p>
</li>
<li><p>I have always felt that being a person and looking at problems can not be extreme. The world is not black and white, but a continuous value between the two. It is impossible to say that either it will be an open-domain giant bot or a bot that has no specific functions. You cannot just see that the existing bot is immature and the fantasy bot is out of reach. In this field, I also laughed at others for being able to get investment. There is no point in arguing. What is really meaningful is to dig deep into this field, find the pain points and difficulties, break them one by one, and constantly promote the development of this field, instead of being boring like some street-watchers! Before breakthroughs in many areas, it seemed that there was no light in sight, but after a few years, many of the problems that were difficult to solve at the time were not all in the Red Sea, were they all over the streets? It may be difficult to make a general-purpose bot for a long time, but there is still hope to make a bot solution with high availability and good scalability. You don’t need to be over-confident, and you don’t need to be humble, and do it steadily. That’s it.</p>
</li>
</ol>
<h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><p>[1] A Survey of Available Corpora for Building Data-Driven Dialogue Systems</p>
<p>[2] A Neural Conversational Model</p>
<p>[3] A Diversity-Promoting Objective Function for Neural Conversation Models</p>
<p>[4] A Hierarchical Latent Variable Encoder-Decoder Model for Generating Dialogues</p>
<p>[5] Sequence to Backward and Forward Sequences: A Content-Introducing Approach to Generative Short-Text Conversation</p>
<p>[6] A Persona-Based Neural Conversation Model</p>
<p>[7] Deep Reinforcement Learning for Dialogue Generation</p>
<p>[8] End-to-end LSTM-based dialog control optimized with supervised and reinforcement learning</p>
<p>[9] A Network-based End-to-End Trainable Task-oriented Dialogue System</p>
<p>[10] Incorporating Unstructured Textual Knowledge Sources into Neural Dialogue Systems</p>
<p>[11] A Neural Network Approach to Context-Sensitive Generation of Conversational Responses</p>
<p>[12] A Dataset for Research on Short-Text Conversation</p>
<p>[13] The Ubuntu Dialogue Corpus: A Large Dataset for Research in Unstructured Multi-Turn Dialogue Systems</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bot/" rel="tag">bot</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-shallow_bot2"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/08/20/shallow_bot2/"
    >Think about Bot 2</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/08/20/shallow_bot2/" class="article-date">
  <time datetime="2020-08-20T15:50:55.000Z" itemprop="datePublished">2020-08-20</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/shallow-understanding/">shallow understanding</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><h3 id="2-user-modeling"><a href="#2-user-modeling" class="headerlink" title="2. user modeling"></a>2. user modeling</h3><p>Article [6] addresses the problem of inconsistent responses in multiple rounds of dialogue. Taking user identity (such as background information, user portrait, age, and other information) into the model, a personalized seq2seq model is constructed for different users. , And the same user generates different styles of responses for different requests.</p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gk0yjoq0wbj30k708fmxn.jpg"></p>
<p>The model of [6] is called Speaker Model, which is a typical seq2seq model. The difference is that a speaker embedding is added to the decoding part, which is similar to word embedding, except that the user is modeled here. Because the user’s information cannot be modeled explicitly, an embedding method is used to obtain the speaker vector through training. The figure on the left below is the representation of the speaker vector on a two-dimensional plane. Users with similar background information It will be very close, which is the same as the word vector.</p>
<h3 id="3-reinforcement-learning-model"><a href="#3-reinforcement-learning-model" class="headerlink" title="3. reinforcement learning model"></a>3. reinforcement learning model</h3><p>Using reinforcement learning to solve human-computer dialogue problems has a long history, but with the hype of AlphaGo, deepmind has brought reinforcement learning back to the stage and combined with deep learning to solve some more difficult problems.</p>
<p>Reinforcement learning uses long term reward as the objective function, which will enable the model to predict higher quality responses after training. The article [7] proposed a model framework with the following capabilities:</p>
<ol>
<li><p>Integrate the reward function defined by the developer to achieve the goal.</p>
</li>
<li><p>After generating a response, you can quantitatively describe the impact of this response on subsequent stages.</p>
</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gk0yke1oz3j30oh0bnwfc.jpg"></p>
<p>Two bots are in a conversation. Initially, an input message is given, and then bot1 generates 5 candidate responses based on the input, and then proceeds sequentially, because each input generates 5 responses. As the turn increases, the response will increase exponentially , Here in each round of dialogue, select 5 as the response of the current round through sample.</p>
<p>Train a good seq2seq on a large data set as the initial value, and use reinforcement learning to improve the model’s ability to implement a custom reward function to achieve the desired effect.</p>
<p>The model in article [7] can generate more rounds of dialogue without falling into an infinite loop prematurely, and the generated dialogue diversity is very good.</p>
<h3 id="4-task-oriented-seq2seq-model"><a href="#4-task-oriented-seq2seq-model" class="headerlink" title="4. task-oriented seq2seq model"></a>4. task-oriented seq2seq model</h3><p>Most of the existing task-oriented bots use rule-based, template-based or example-based or a combination of them, and data driven solutions are very rare. Articles [8] and [9] try to use deep learning techniques on individual parts of the bot, and give practical solutions.</p>
<p>Article [8] first introduces a well-known scene, how an experienced customer service brings a new customer service, divided into four stages:</p>
<ol>
<li><p>Tell the new customer service what “controls” are available, such as: how to find customer information, how to determine customer identity, etc.</p>
</li>
<li><p>The new customer service imitates and learns from the good examples made by the old customer service.</p>
</li>
<li><p>The new customer service began to try to serve the customer, and the old customer service corrected his mistakes in time.</p>
</li>
<li><p>The old customer service will let go, and the new customer service will serve customers alone, keep learning and accumulate experience.</p>
</li>
</ol>
<p>The model framework of [8] is designed according to the above process:</p>
<ol>
<li><p>The developer provides a series of alternative actions, including response templates and some API functions, to be called by the bot.</p>
</li>
<li><p>Experts provide a series of example dialogues and use RNN to learn.</p>
</li>
<li><p>A simulated user randomly generates a query, a bot responds, and an expert corrects it.</p>
</li>
<li><p>Bot goes online for service, talks with real customers, and improves bot service quality through feedback.<br><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gk0yl8y707j30t809j3yu.jpg"></p>
</li>
</ol>
<p>When training, a part of high-quality data is used for supervised learning SL, and reinforcement learning RL is used to optimize the model to obtain higher quality results.</p>
<p>The article [9] balances the advantages and disadvantages of two popular schemes, and proposes a set of reference value and practical seq2seq solutions.</p>
<h3 id="6-Knowledge-Sources-based-model"><a href="#6-Knowledge-Sources-based-model" class="headerlink" title="6. Knowledge Sources based model"></a>6. Knowledge Sources based model</h3><p>Pure seq2seq can solve many problems, but for specific tasks, adding a related knowledge source on the basis of seq2seq will make the effect much better. The knowledge here can be unstructured text sources, such as the ubuntu manpages in article [10], or structured business data, such as the database in article [9], or it can be a source data and business data The extracted knowledge graph.</p>
<p>The author of the article [10] defines the bot task as next utterance classification, which is a bit like a question answering task. Given a context and a response candidate list as candidate answers, select the correct response from the candidate list through the context. The contribution of this article lies in the introduction of task-related external professional knowledge base on the basis of context, and this knowledge base is unstructured.</p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gk0ym1poayj30gz078glx.jpg"></p>
<p>The model is composed of three rnn encoders, one rnn to encode context, one rnn to encode response, and one rnn to encode knowledge, and then make predictions together to select the most suitable response. The model is called a knowledge encoder. Because the data set is related to ubuntu technical support, ubuntu manpages is used for external resources.</p>
<h3 id="7-context-sensitive-model"><a href="#7-context-sensitive-model" class="headerlink" title="7. context sensitive model"></a>7. context sensitive model</h3><p>The model in article [11] is relatively simple, but the issues considered are of great significance. The modeling of history information is of great help to bots in solving practical engineering applications, and directly determines whether your bot can work. The author expresses the history context with a bag of words model instead of the rnn we often use, and then passes the context and user query through a simple FNN to get an output.</p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gk0ymlc3o5j305j0acweh.jpg"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bot/" rel="tag">bot</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-shallow_bot1"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/08/13/shallow_bot1/"
    >Think about Bot 1</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2020/08/13/shallow_bot1/" class="article-date">
  <time datetime="2020-08-13T15:50:55.000Z" itemprop="datePublished">2020-08-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/shallow-understanding/">shallow understanding</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><em>Thinking during the internship in HCI group</em></p>
<p>Chatbot is a word or an application that has been very popular recently. Not only are the major news media hyping up the concept of bots, but major giants have also invested huge resources in research and development.  I have to say that an embarrassing fact is that it is really difficult to find a really useful bot on the market. According to the field involved, bots are divided into open-domain and task-oriented bots. The open domain has a lot to do, and it’s more like a platform that can do anything. No matter what kind of needs you raise, it can solve it. It means true AI, while task-oriented bots focus on doing a good job. Things, booking air tickets, order meals, get passports, etc.</p>
<p>When it comes to open-domain bots, the ones that everyone comes into contact with the most are entertainment bots that have very nonsensical answers. The bot companies that use deep learning to solve bot technology are all of this type. They can’t solve any practical problems. They can just talk to everyone. And many times the answer is that they are not right, which is very ridiculous.</p>
<p>Let’s talk about task-oriented bots. The most popular one on the market is customer service robots, whether it’s a bank or an e-commerce company. If you don’t want to answer the user’s questions repeatedly, just use a customer service bot to respond and develop a specific task. The bot requires a lot of work and a lot of maintenance in the later period. Because too many hand crafted features are used, the horizontal scalability of the entire bot framework is relatively poor. </p>
<h2 id="Problem-Description"><a href="#Problem-Description" class="headerlink" title="Problem Description"></a>Problem Description</h2><p>Bot is a comprehensive problem involving the following three main issues:</p>
<h3 id="1-Response-generation-selection"><a href="#1-Response-generation-selection" class="headerlink" title="1. Response generation (selection)"></a>1. Response generation (selection)</h3><p>The dialog generation is the last step, the output part. In a brief summary, there are four solutions:</p>
<p>Solution 1 generates dialogue directly based on context. There are a lot of recent papers in this regard, especially after the seq2seq+attention framework has swept many tasks of NLP, the benchmark generated by dialogue has been refreshed by various models again and again. The problem of dialogue generation is defined as a generative model based on a certain condition. Typically, predict words based on context. When it comes to sentence generation, the evaluation problem will be a more difficult problem.</p>
<p>Solution 2 Of course, some papers do not define dialogue generation as a language model problem, but a next utterance selection problem, a multiple choice problem, given a context, given a utterance candidate list, select one from the list As a response, of course, this type of problem is much less difficult and very easy to evaluate, but it takes more effort to prepare the data set, and it is not easy to learn from in practical applications.</p>
<p>Solution 3 rule-based or template-based, the final form of response is actually filled with a template, most of the things are given, only some specific values ​​need to be filled. This type of solution is very suitable for task-oriented bots, but too many manual features and templates make it difficult to port to other tasks.</p>
<p>Solution 4 query-based or example-based, the response comes from a database called a knowledge base, which contains a large number of rich examples, according to the user’s query, find the closest example, and return the corresponding response as Output. This type of solution is very suitable for entertainment and funny bots. The core technology is to find more data to enrich and clean the knowledge base. But after all, respnose is taken from others, which may be funny, but most of them will be wrong.</p>
<h3 id="2-dialog-state-tracking-DST"><a href="#2-dialog-state-tracking-DST" class="headerlink" title="2. dialog state tracking (DST)"></a>2. dialog state tracking (DST)</h3><p>Some papers call DST the belief trackers. This component is actually the core of the bot. Its function is to understand or capture user intention or goal. Only when you really know what the user needs can you make the correct action or response. For this part, there will be a Dialog State Tracking Challenge competition. Generally speaking, a range of state is given, and the context is used to predict which state the user belongs to, what kind of needs they have, and whether they need to query the weather or train tickets.</p>
<h3 id="3-User-modeling"><a href="#3-User-modeling" class="headerlink" title="3. User modeling"></a>3. User modeling</h3><p>The bot is oriented to specific businesses and deals with real users. If it is just a simple FAQ bot, it may not be necessary to answer a few common questions, but if it is other more complex and detailed businesses, it needs to be provided to users. Modeling, the same problem, the response that the bot gives to each person must be different, the reason is very simple. User modeling needs to involve not only simple basic user information and some explicit feedback information of the user, but more importantly the history conversations of the user, these implicit feedback information. It’s like before the recommendation system went viral, everyone was selling things fairly, but some smart people started to analyze user behavior, not only those likes, but also the “clues” left by users inadvertently. In this way, we know what users are potentially interested in, which is what the recommendation system is doing later. Modeling the user is to make a personalized bot, and each response generated has the distinctive characteristics of the user.</p>
<h2 id="Corpus"><a href="#Corpus" class="headerlink" title="Corpus"></a>Corpus</h2><p>Large-scale corpora are used to train open-domain bot dialogue generation models, and data sources are generally from social networking sites. For task-oriented bots, the size of customer data is generally very small. This is one of the main reasons why it is difficult to directly apply data driven solutions to task-oriented bots.</p>
<p>The survey of bot training corpus is given in [1].</p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gk0yfyvum5j30l208hgmg.jpg"></p>
<p>The picture comes from the article [13]. There are indeed many English corpora. The corpus of Sina Weibo was released by Huawei’s Noah’s Ark Lab [12]. If bot data is generated from twitter or Weibo, the effect of “conversational in nature” is not as good as the data generated from chat rooms such as ubuntu chat logs, which is more suitable for training response generation models, because it is more natural and pollution-free. The article [5] also uses a large Chinese corpus, with data from Baidu Tieba.</p>
<h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><p>There are too many papers studying bots. This is a very active research field, and there are many subdivisions. Next, we will introduce some models according to the research questions targeted.</p>
<h3 id="1-seq2seq-generative-model"><a href="#1-seq2seq-generative-model" class="headerlink" title="1. seq2seq generative model"></a>1. seq2seq generative model</h3><p>The most popular solution now is seq2seq+attention, the encoder feeds the user query feed in, outputs a vector representation to represent the entire query, and then serves as the condition of the decoder, and the decoder is essentially a language model that generates the response step by step, [2 ] Adopting this kind of scheme, Google used a large number of parameters to train such a model and got a good bot.</p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gk0ygs7tbtj30gt04eaa0.jpg"></p>
<p>There is a problem with typical seq2seq, that is, it is easy to generate some “huh” responses, that is, some very safe, grammatical but meaningless responses, such as “I don’t know!”. The reason is that traditional seq2seq uses MLE (Maximum Likelihood Estimate) as the objective function in the decoding process, that is, to generate the most grammatical words, not the most useful words. These safe sentences appear in large numbers in the training corpus. After the model learns, It is inevitable that such a response is always generated, and the article [3] draws on some experience in speech recognition, and uses MMI (Maximum Mutual Information) as the objective function when decoding, which improves the diversity of the response.</p>
<p>The article [4] believes that the fundamental reason for the low quality of human speech generated by language models like RNNLM is that the random feature or noise hidden in utterance is not handled properly, thus generating next token (short term goal) and future tokens (long term goal) have a mediocre effect.</p>
<p><img src="https://tva1.sinaimg.cn/large/0081Kckwgy1gk0yhyje8pj30lq0bnwfn.jpg"></p>
<p>When generating each utterance, four parts are needed, encoder RNN, context RNN, latent variable, decoder RNN, which are input and output in sequence. The latent variable here is a bit similar to the LSI in the IR. Latent shows that we can’t tell what they are, but it may represent a topic or sentiment, a representation of dimensionality reduction.</p>
<p>The article [5] proposed a method called content introducing to generate short text response.</p>
<p>Step 1 After a given query, predict a keyword as the topic of the response. This topic part of speech is a noun. The keyword here cannot capture complex semantics and grammar, but only predicts a PMI (Pointwise Mutual) based on each word in the query. Information) The highest noun is used as the keyword.</p>
<p>The model of step 2 [5] is called Sequence To Backward and Forward Sequences. First, a backward step is performed. Given a query, express it with an encoder to get a context. In the decoder part, first give the keyword as the first word, and then perform decoding. The generated part is equivalent to the part in front of the keyword; the next step is forward step, which is also a typical seq2seq. The query is expressed as a context with an encoder, and then given the words generated by the backward and the keyword as the first half of the decoder, continue decoding Generate the second half. The entire process is briefly described as follows:</p>
<p>step 1 query + keyword =&gt; backward sequence</p>
<p>step 2 query + keyword + backward sequence(reverse) =&gt; forward sequence</p>
<p>step 3 response = backward (reverse) sequence + keyword + forward sequence</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bot/" rel="tag">bot</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-sketch_killing_commendatore"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2018/06/23/sketch_killing_commendatore/"
    >Reading Killing Commerndatore</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2018/06/23/sketch_killing_commendatore/" class="article-date">
  <time datetime="2018-06-23T15:50:55.000Z" itemprop="datePublished">2018-06-23</time>
</a>  
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="KILLING-COMMENDATORE"><a href="#KILLING-COMMENDATORE" class="headerlink" title="KILLING COMMENDATORE"></a>KILLING COMMENDATORE</h2><p><strong>People and countries must learn to coexist with the painful past</strong></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjqnnkqlm0j30m80vj40e.jpg"></p>
<p>This time, Murakami is still following the “lost–exploration–discovery–lost again” approach, shaping the loneliness, alienation and predicament in contemporary life, but something is different.</p>
<p>If one’s life is selfish, most people’s life is just an irreversible and only experience with no special meaning. It is true that we, as an individual, cannot trace history, but Murakami has been asking about the past rationally.</p>
<p>Many people say that this book is a masterpiece of Murakami. The Murakami style of this book is very clear. He is very good at controlling multiple main lines, and alternating representativeness and concreteness, independent and interrelated. The Murakami world is the expression of each other. </p>
<p>Murakami seems to be a person who <strong>strives to stop time</strong>. He has a paranoid time concept and living habits, without the fetters of children. He maximizes his time on very few things, so his spiritual world is huge and small. No exception is that “Knight” is also a Murakami-style protagonist. </p>
<blockquote>
<p>He has a little money but is not a rich man, so there are few fetters,<br>a high degree of freedom, and his own unique hobbies and make people<br>feel that Unique personality or skills, people who have a relatively<br>fixed partner or a relatively fixed feeling of a partner, seem to be<br>relatively calm about everything, but actually have no sense of<br>restraint.</p>
</blockquote>
<p>This kind of protagonist has a very chic life, so he is almost connected with “strange things”. But this book is different from the previous one in that it is a “circle”. He basically explained all the stories clearly, although there are still places that are not the truth (such as who’s child Muro and Marie Kee are). </p>
<p>The title of the book is not only a famous painting by the artist in the book, but also an important main line concept in the book. The leader of the knight is a metaphor for long-faced people and onlookers. Girl Donna Anna. The climax of the book occurs when the protagonist assassinates the knight leader (idea) to save the girl under the instruction of the knight leader (idea), and leads to the long-faced man who has been observed and recorded, and passes the long-faced man and the faceless man through the river of existence , And with the help of the bystander Donna, return to the original point, and the protagonist is reborn.</p>
<p>The “I” in the book used to think that the assassination of the knight leader was a failed assassination activity when he was young. The painter joined an organization when he was studying in Vienna. Because he could not stand violent politics, he tried to assassinate someone in exchange for a short period of peaceful time. But unfortunately the plan failed. Except for the painter’s life-long silence, the entire organization survived, and the painter’s girlfriend (the protagonist thought it was Donna’s role) was unable to escape.<br>The soul of the painter’s life is also a shame of silence in his life.<br>Does the painter paint this painting as a record of himself, and the metaphor of “long-faced man” who is timid and dare not say anything?<br>The faceless people need special items as a salary to save people. Is it because the painter can’t help himself to survive without expression and emotion, but at the same time there is no development of right and wrong, so the painter does not know what the face of those people. Is it kind or ugly, that’s why it’s called a faceless person who is alive but has no face?<br>The author of the last double-layer metaphor “white Subaru man” that claimed “I know everything you do” thought it might be a crime in his own body, so if there was a big problem in Vienna back then, now, “I” is going through the comic In the dark, is it the inner demon who almost swallows oneself?</p>
<p>Murakami finally summed up all possible brain holes with a “circle”. Although the past has passed, it seems that life has returned and developed, but the memory remains the same, the destiny is a ring, and the unresolved ones will always be found in stillness. This is something no one can avoid. </p>
<p>That painting is over, and the assassination of “I” is also over, but it leaves two doubts about where will be placed objectively with the growth of Keiwa Shima, history Even if you forget, the reality is still there. Perhaps this is what Murakami said before, “between the rock and the egg, I will always choose the side of the egg.” </p>
<p>Human feelings cannot be forgotten.</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/life/" rel="tag">life</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/read/" rel="tag">read</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-sketch_reading_interestingly"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2018/03/01/sketch_reading_interestingly/"
    >Reading with Interest</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2018/03/01/sketch_reading_interestingly/" class="article-date">
  <time datetime="2018-03-01T16:50:55.000Z" itemprop="datePublished">2018-03-01</time>
</a>  
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>Watching Japanese dramas always makes me feel touched, and I felt that way when I watched “Kono Etsuko” this week. Kono Etsuko is indeed a lovely person, full of energy, and moving towards her ideals. Even if she has to detour halfway, she can walk seriously step by step on the road that she doesn’t want to go. </p>
<p>She originally wanted to be an editor of a fashion magazine, but she has not been enrolled for eight years. In the eighth year, she finally entered the publishing house where the magazine was located, but was sent to the proofreading department. There was no sense of achievement, and she was responsible for picking out the verbal errors and inconsistent parts for various publications. But she still carefully did her own job.<br><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjqnijb9paj30hs0a1wer.jpg"></p>
<p>Once a literary editor asked her why she only wanted to be a fashion magazine editor, but still willing to complete all proofreading work vigorously? She said that in fact, every proofreading job is helpful to becoming an editor in the future. For example, there was once a book proofreading about snake breeding. After careful proofreading, you can remember many types of snakes. Then as a fashion magazine editor in the future, when you need snake skin products, she can ask others what kind of snakes they need. </p>
<p>She is not that great and cannot accomplish many things at the same time. However, she always takes what she is doing seriously. It is because of her serious attitude that she is truly recognized by colleagues in the proofreading department. </p>
<hr>
<p>I have always been a person with a lot of mood swings, and I get depressed very easily. It’s hard to concentrate on completing tasks every time I’m feeling down, so I need to find something that can heal me. When I watched anime since I was young, I also liked watching Healing Xiang anime the most, but recently I have no patience to watch slow-paced anime. So every time I can find a cure for my TV series, I am very happy. Following the plot, I was naturally attracted, substituted in, and smiled warmly when the protagonist was cared for, and my mood soon brightened. This is probably a feeling of “the world has its own true feelings”. </p>
<p>If you can be protected, you are not afraid of injury.</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjqni4c4evj30zk0jzwfx.jpg"></p>
<p>Reading is of course a way for me to heal myself, but at the beginning of this week I always couldn’t read books. I always want to read some more in-depth, more professional books, in order to increase the posture, but I can’t read it anymore, and I look for a lot of Japanese TV dramas because of some self-destructiveness. But I saw the plot in “Kono Etsuko”: The hero is a very literary writer, but the book he wrote is quite boring. People around him said that, in fact, a good book (at least for publishers) should first be a book that others will unconsciously lament “interesting” after reading it.</p>
<p><strong>I kind of like this expression. I want to write because I have been moved and comforted by other people’s words, so I also want to write words that can touch and comfort others.</strong></p>
<p>Later this week, I read some reasoning, science fiction, and Wang Xiaobo’s “Black Iron Age”. I have to say that Wang Xiaobo is indeed a very interesting person.</p>
<p>There is a very special story in “Dark Iron Age”, “East Palace West Palace”, which is about male homosexuality. This story has been included in the book three times, as a novel, a movie script and a stage script respectively, which shows that its value is still quite high. Recently, the topic of homosexuality has been raging. In fact, many writers or public figures like Wang Xiaobo have shown their understanding and tolerance of homosexuality. Today, a department of People’s Daily also published an article on understanding homosexuality. I remember that Shi Tiesheng also wrote similar words, love is the same, everyone may have an object of love, but some people happen to be male, and some are female. Therefore, first there is love and the object of love, and secondly, the gender of the object is judged.</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjqnhrsb8zj30hs0a0gm6.jpg"></p>
<p>I also real some physiological psychology relevant literature. For men, there is evidence that there are subtle differences between heterosexual and homosexual physiology, and this difference is often innate. Plus, sexual orientation is not an all-or-nothing thing, so this difference means that some men naturally like women more and some men naturally like men more. There is nothing wrong with blame. It cannot be said that this group is wrong just because the relative number is small.</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/life/" rel="tag">life</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/read/" rel="tag">read</a></li></ul>

    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-py12-API"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2017/10/13/py12-API/"
    >API</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2017/10/13/py12-API/" class="article-date">
  <time datetime="2017-10-13T15:50:55.000Z" itemprop="datePublished">2017-10-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="1-Use-WebAPI"><a href="#1-Use-WebAPI" class="headerlink" title="1. Use WebAPI"></a>1. Use WebAPI</h2><h4 id="Processing-API-response"><a href="#Processing-API-response" class="headerlink" title="Processing API response"></a>Processing API response</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment"># Execute API call and store response</span></span><br><span class="line">url =<span class="string">&#x27;https://api.github.com/search/repositories?q=language:python&amp;sort=stars&#x27;</span></span><br><span class="line">r = requests.get(url)</span><br><span class="line">print(<span class="string">&quot;Status code:&quot;</span>, r.status_code)</span><br><span class="line"><span class="comment"># Store the API response in a variable</span></span><br><span class="line">response_dict = r.json()</span><br><span class="line"><span class="comment"># process result </span></span><br><span class="line">print(response_dict.keys())</span><br></pre></td></tr></table></figure>
<p>The attribute named status_code, which lets us know whether the request was successful (status code 200 means the request was successful)<br>This API returns information in JSON format, so we use the method json() to convert this information into a Python dictionary. We store the converted dictionary in response_dict.</p>
<h4 id="Print"><a href="#Print" class="headerlink" title="Print"></a>Print</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">repo_dicts = response_dict[<span class="string">&#x27;items&#x27;</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;Name:&#x27;</span>, repo_dict[<span class="string">&#x27;name&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;Owner:&#x27;</span>, repo_dict[<span class="string">&#x27;owner&#x27;</span>][<span class="string">&#x27;login&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;Stars:&#x27;</span>, repo_dict[<span class="string">&#x27;stargazers_count&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;Repository:&#x27;</span>, repo_dict[<span class="string">&#x27;html_url&#x27;</span>])</span><br></pre></td></tr></table></figure>

<h4 id="Rate"><a href="#Rate" class="headerlink" title="Rate"></a>Rate</h4><p>Most APIs have rate limits, that is, there is a limit on the number of requests you can execute within a certain period of time.<br><a target="_blank" rel="noopener" href="https://api.github.com/rate_limit">https://api.github.com/rate_limit</a></p>
<h2 id="2-Use-Pygal-to-visualize-the-warehouse"><a href="#2-Use-Pygal-to-visualize-the-warehouse" class="headerlink" title="2. Use Pygal to visualize the warehouse"></a>2. Use Pygal to visualize the warehouse</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pygal</span><br><span class="line"><span class="keyword">from</span> pygal.style <span class="keyword">import</span> LightColorizedStyle <span class="keyword">as</span> LCS, LightenStyle <span class="keyword">as</span> LS</span><br><span class="line"></span><br><span class="line">my_style = LS(<span class="string">&#x27;#333366&#x27;</span>, base_style=LCS)</span><br><span class="line">chart = pygal.Bar(style=my_style, x_label_rotation=<span class="number">45</span>, show_legend=<span class="literal">False</span>)</span><br><span class="line">chart.title =<span class="string">&#x27;Most-Starred Python Projects on GitHub&#x27;</span></span><br><span class="line">chart.x_labels = names</span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-py11-download"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2017/10/13/py11-download/"
    >Download Data</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2017/10/13/py11-download/" class="article-date">
  <time datetime="2017-10-13T10:50:55.000Z" itemprop="datePublished">2017-10-13</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="1-CSV-file-format"><a href="#1-CSV-file-format" class="headerlink" title="1.CSV file format"></a>1.CSV file format</h2><p>To store data in a text file, the easiest way is to write the data as a series of comma-separated values ​​(CSV) to the file.<br>The reader processes the first line of data separated by commas in the file, and stores each item of data as an element in the list.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">highs = []</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">highs.append(row[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">or</span></span><br><span class="line"></span><br><span class="line">high = int(row[<span class="number">1</span>])</span><br><span class="line">highs.append(high)</span><br></pre></td></tr></table></figure>
<h4 id="Module-datetime"><a href="#Module-datetime" class="headerlink" title="Module datetime"></a>Module datetime</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">first_date = datetime.strptime(<span class="string">&#x27;2014-7-1&#x27;</span>,<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">print(first_date)</span><br></pre></td></tr></table></figure>
<p>The method strptime() accepts various arguments and decides how to interpret the date based on them.</p>
<h4 id="Picture-coloring"><a href="#Picture-coloring" class="headerlink" title="Picture coloring"></a>Picture coloring</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(dates, lows, c=<span class="string">&#x27;blue&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br></pre></td></tr></table></figure>
<p>Alpha value 0 means completely transparent, 1 (default setting) means completely opaque. By setting alpha to 0.5, you can make the red and blue polylines look lighter.</p>
<h4 id="check-for-errors"><a href="#check-for-errors" class="headerlink" title="check for errors"></a>check for errors</h4><p>Prevent empty data sets</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">current_date = datetime.strptime(row[<span class="number">0</span>], <span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line">high = int(row[<span class="number">1</span>])</span><br><span class="line">low = int(row[<span class="number">3</span>])</span><br><span class="line"><span class="keyword">except</span> ValueError:</span><br><span class="line">print(current_date,<span class="string">&#x27;missing data&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">dates.append(current_date)</span><br><span class="line">highs.append(high)</span><br><span class="line">lows.append(low)</span><br></pre></td></tr></table></figure>


<h2 id="2-Making-a-world-population-map-JSON-format"><a href="#2-Making-a-world-population-map-JSON-format" class="headerlink" title="2. Making a world population map: JSON format"></a>2. Making a world population map: JSON format</h2><h4 id="Print"><a href="#Print" class="headerlink" title="Print"></a>Print</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">filename =<span class="string">&#x27;Downloads/population_data.json&#x27;</span></span><br><span class="line"><span class="keyword">with</span> open(filename) <span class="keyword">as</span> f:</span><br><span class="line">    pop_data = json.load(f) <span class="comment">#list</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pop_dict <span class="keyword">in</span> pop_data:</span><br><span class="line">    <span class="keyword">if</span> pop_dict[<span class="string">&#x27;Year&#x27;</span>] == <span class="string">&#x27;2010&#x27;</span>: <span class="comment">#Dictionary</span></span><br><span class="line">        country_name = pop_dict[<span class="string">&#x27;Country Name&#x27;</span>]</span><br><span class="line">        population = pop_dict[<span class="string">&#x27;Value&#x27;</span>]</span><br><span class="line">        print(country_name + <span class="string">&quot;: &quot;</span>+ population)</span><br></pre></td></tr></table></figure>

<h4 id="Data-processing"><a href="#Data-processing" class="headerlink" title="Data processing"></a>Data processing</h4><p>Each key and value in population_data.json is a string. To process these demographic data, we need to represent people<br>The number of strings is converted to a numeric value, for this we use the function <strong>int()</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">population = int(pop_dict[<span class="string">&#x27;Value&#x27;</span>])</span><br><span class="line">print(country_name + <span class="string">&quot;: &quot;</span>+ str(population))</span><br></pre></td></tr></table></figure>
<p>Python cannot directly convert the string ‘1127437398.85751’ containing a decimal point to an integer<br>To eliminate this error, we first convert the string to a floating point number, and then convert the floating point number to an integer</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">population = int(float(pop_dict[<span class="string">&#x27;Value&#x27;</span>]))</span><br></pre></td></tr></table></figure>
<p>The map making tool in Pygal requires the data to be in a specific format:<br>Use country codes to represent countries and numbers to represent populations. When processing geopolitical data, several standardized country code sets are often used.<br>The country code used by Pygal is stored in the module i18n (abbreviation for internationalization)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pygal.i18n <span class="keyword">import</span> COUNTRIES</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> country_code <span class="keyword">in</span> sorted(COUNTRIES.keys()):</span><br><span class="line">print(country_code, COUNTRIES[country_code])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_country_code</span>(<span class="params">country_name</span>):</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;Returns the two-letter country code used by Pygal according to the specified country&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> code, name <span class="keyword">in</span> COUNTRIES.items():</span><br><span class="line"><span class="keyword">if</span> name == country_name:</span><br><span class="line"><span class="keyword">return</span> code</span><br><span class="line"><span class="comment"># If the specified country is not found, return None</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>

<h4 id="Making-a-world-map"><a href="#Making-a-world-map" class="headerlink" title="Making a world map"></a>Making a world map</h4><p><img src="https://img-blog.csdnimg.cn/20191110053541496.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTY1NjM4Mw==,size_16,color_FFFFFF,t_70"></p>
<h4 id="Set-up-the-map"><a href="#Set-up-the-map" class="headerlink" title="Set up the map"></a>Set up the map</h4><p>Add numbers</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wm.add(<span class="string">&#x27;North America&#x27;</span>, &#123;<span class="string">&#x27;ca&#x27;</span>: <span class="number">34126000</span>,<span class="string">&#x27;us&#x27;</span>: <span class="number">309349000</span>,<span class="string">&#x27;mx&#x27;</span>: <span class="number">113423000</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>Add color</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pygal.style <span class="keyword">import</span> RotateStyle</span><br><span class="line">wm_style = RotateStyle(<span class="string">&#x27;#336699&#x27;</span>)</span><br><span class="line">wm = pygal.Worldmap(style=wm_style)</span><br></pre></td></tr></table></figure>
<p>Pygal will choose the default base color. To set the color, you can use RotateStyle, and use LightColorizedStyle as the basic style.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pygal.style <span class="keyword">import</span> LightColorizedStyle, RotateStyle</span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-py10-data"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2017/10/12/py10-data/"
    >Generated Data</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2017/10/12/py10-data/" class="article-date">
  <time datetime="2017-10-12T10:50:55.000Z" itemprop="datePublished">2017-10-12</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="1-Draw-a-simple-line-chart"><a href="#1-Draw-a-simple-line-chart" class="headerlink" title="1. Draw a simple line chart"></a>1. Draw a simple line chart</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">squares = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>]</span><br><span class="line">plt.plot(squares, linewidth=<span class="number">5</span>) <span class="comment">#The thickness of the drawn line</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Set icon title, axis label</span></span><br><span class="line">plt.title(<span class="string">&quot;Square Numbers&quot;</span>, fontsize=<span class="number">24</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Value&quot;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Square of Value&quot;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Scale mark size</span></span><br><span class="line">plt.tick_params(axis=<span class="string">&#x27;both&#x27;</span>, labelsize=<span class="number">14</span>) <span class="comment">#Set the style of scale</span></span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20191108042648749.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTY1NjM4Mw==,size_16,color_FFFFFF,t_70"></p>
<h4 id="1-1-Correction-graphics"><a href="#1-1-Correction-graphics" class="headerlink" title="1.1 Correction graphics"></a>1.1 Correction graphics</h4><p>When you provide a series of numbers to plot(), it assumes that the x coordinate value of the first data point is 0, but our first<br>The x value corresponding to the point is 1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input_values ​​= [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">squares = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">25</span>]</span><br><span class="line">plt.plot(input_values, squares, linewidth=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h4 id="1-2-Scatter-chart"><a href="#1-2-Scatter-chart" class="headerlink" title="1.2 Scatter chart"></a>1.2 Scatter chart</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">x_values ​​= list(range(<span class="number">1</span>,<span class="number">1001</span>))</span><br><span class="line">y_values ​​= [x**<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> x_values]</span><br><span class="line"></span><br><span class="line">plt.scatter(x_values, y_values, s=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&quot;Square Numbers&quot;</span>, fontsize=<span class="number">24</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;Value&quot;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;Square of Value&quot;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">plt.tick_params(axis=<span class="string">&#x27;both&#x27;</span>, which=<span class="string">&#x27;major&#x27;</span>, labelsize=<span class="number">14</span>)</span><br><span class="line">plt.axis([<span class="number">0</span>,<span class="number">1100</span>,<span class="number">0</span>,<span class="number">1100000</span>]) <span class="comment">#Coordinate axis range</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20191108043804540.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTY1NjM4Mw==,size_16,color_FFFFFF,t_70"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Delete data outline</span></span><br><span class="line">plt.scatter(x_values, y_values, edgecolor=<span class="string">&#x27;none&#x27;</span>, s=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Custom color</span></span><br><span class="line">plt.scatter(x_values, y_values, c=<span class="string">&#x27;red&#x27;</span>, edgecolor=<span class="string">&#x27;none&#x27;</span>, s=<span class="number">40</span>)</span><br><span class="line">plt.scatter(x_values, y_values, c=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.8</span>), edgecolor=<span class="string">&#x27;none&#x27;</span>, s=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Color mapping</span></span><br><span class="line">plt.scatter(x_values, y_values, c=y_values, cmap=plt.cm.Blues, edgecolor=<span class="string">&#x27;none&#x27;</span>, s=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save</span></span><br><span class="line">plt.savefig(<span class="string">&#x27;squares_plot.png&#x27;</span>, bbox_inches=<span class="string">&#x27;tight&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-Random-walk"><a href="#2-Random-walk" class="headerlink" title="2. Random walk"></a>2. Random walk</h3><h4 id="2-1-Create-RandomWalk-class"><a href="#2-1-Create-RandomWalk-class" class="headerlink" title="2.1 Create RandomWalk() class"></a>2.1 Create RandomWalk() class</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> len(self.x_values) &lt;self.num_points:</span><br><span class="line">    x_direction = choice([<span class="number">1</span>,<span class="number">-1</span>])</span><br><span class="line">    x_distance = choice([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">    x_step = x_direction * x_distance</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20191108180626828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTY1NjM4Mw==,size_16,color_FFFFFF,t_70"></p>
<h4 id="2-2-Set-the-style-of-random-walk-graph"><a href="#2-2-Set-the-style-of-random-walk-graph" class="headerlink" title="2.2 Set the style of random walk graph"></a>2.2 Set the style of random walk graph</h4><p>Use color mapping to point out the order of the points in the stroll, and delete the black outline of each point to make their colors more obvious<br><img src="https://img-blog.csdnimg.cn/20191108181605699.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl8zOTY1NjM4Mw==,size_16,color_FFFFFF,t_70"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lly1122334/article/details/88535217">Refer to the use of cmap</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">#Window size</span></span><br><span class="line">    plt.figure(figsize=(<span class="number">10</span>,<span class="number">6</span>))</span><br><span class="line">    </span><br><span class="line"><span class="comment">#range() generates a list of numbers, which contains the same number of numbers as the number of points in the walk</span></span><br><span class="line">    point_numbers = list(range(rw.num_points))</span><br><span class="line">    <span class="comment">#Coloring</span></span><br><span class="line">    plt.scatter(rw.x_values, rw.y_values, c=point_numbers, cmap=<span class="string">&#x27;Blues&#x27;</span>, edgecolor=<span class="string">&#x27;none&#x27;</span>, s=<span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">#Highlight the starting point and ending point</span></span><br><span class="line">    plt.scatter(<span class="number">0</span>, <span class="number">0</span>, c=<span class="string">&#x27;green&#x27;</span>, edgecolors=<span class="string">&#x27;none&#x27;</span>, s=<span class="number">100</span>)</span><br><span class="line">    plt.scatter(rw.x_values[<span class="number">-1</span>], rw.y_values[<span class="number">-1</span>], c=<span class="string">&#x27;red&#x27;</span>, edgecolors=<span class="string">&#x27;none&#x27;</span>, s=<span class="number">100</span>)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#Hide axis</span></span><br><span class="line">    plt.axes().get_xaxis().set_visible(<span class="literal">False</span>)</span><br><span class="line">    plt.axes().get_yaxis().set_visible(<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<h3 id="3-Use-Pygal-to-simulate-dice-rolls"><a href="#3-Use-Pygal-to-simulate-dice-rolls" class="headerlink" title="3. Use Pygal to simulate dice rolls"></a>3. Use Pygal to simulate dice rolls</h3><h4 id="3-1-Create-Die-class"><a href="#3-1-Create-Die-class" class="headerlink" title="3.1 Create Die class"></a>3.1 Create Die class</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> randint(<span class="number">1</span>, self.num_sides)</span><br></pre></td></tr></table></figure>
<p>dice</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> roll_num <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">result = die.roll()</span><br><span class="line">results.append(result)</span><br></pre></td></tr></table></figure> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
   
</article>

    
    <article
  id="post-py9-spaceships"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2017/10/12/py9-spaceships/"
    >Armed Spaceship</a> 
</h2>
 

    </header>
     
    <div class="article-meta">
      <a href="/2017/10/12/py9-spaceships/" class="article-date">
  <time datetime="2017-10-12T10:50:55.000Z" itemprop="datePublished">2017-10-12</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h5 id="1-Create-Pygame-window-and-respond-to-user-input"><a href="#1-Create-Pygame-window-and-respond-to-user-input" class="headerlink" title="1. Create Pygame window and respond to user input"></a>1. Create Pygame window and respond to user input</h5><p>alien_invasion.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">run_game</span>():</span></span><br><span class="line"><span class="comment">#Initialize the game and create a screen object</span></span><br><span class="line">pygame.init()</span><br><span class="line">screen = pygame.display.set.mode((<span class="number">1200</span>,<span class="number">800</span>))</span><br><span class="line">pygame.dispaly.set_caption(<span class="string">&quot;Alien Invasion&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Start the main loop of the game</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line"><span class="comment">#Monitor keyboard and mouse events</span></span><br><span class="line"><span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line"><span class="keyword">if</span> event.type == pygame.QUIT:</span><br><span class="line">sys.exit()</span><br><span class="line"></span><br><span class="line"><span class="comment">#Make the recently drawn screen visible</span></span><br><span class="line">pygame.dispaly.flip()</span><br><span class="line"></span><br><span class="line">run_game()</span><br></pre></td></tr></table></figure>

<h5 id="2-Create-a-settings-class-to-include-settings-for-the-game"><a href="#2-Create-a-settings-class-to-include-settings-for-the-game" class="headerlink" title="2. Create a settings class to include settings for the game"></a>2. Create a settings class to include settings for the game</h5><h5 id="3-Add-pictures"><a href="#3-Add-pictures" class="headerlink" title="3. Add pictures"></a>3. Add pictures</h5><p>The best is the bmp diagram<br>In Pygame, the origin (0,0) is located at the upper left corner of the screen. When moving to the lower right, the coordinate value will increase. On a 1200×800 screen, the origin is at the upper left corner, and the coordinates of the lower right corner are (1200, 800).</p>
<h5 id="4-Refactoring-module-game-functions"><a href="#4-Refactoring-module-game-functions" class="headerlink" title="4. Refactoring: module game_functions"></a>4. Refactoring: module game_functions</h5><p>Start by writing the code as simple as possible, and refactor as the project becomes more and more complex.</p>
<h5 id="5-Driving-the-spaceship"><a href="#5-Driving-the-spaceship" class="headerlink" title="5. Driving the spaceship"></a>5. Driving the spaceship</h5><p><strong>Corresponding button</strong><br>Whenever the user presses a key, an event will be registered in Pygame. Events are obtained through the method pygame.event.get(), so in the function check_events(), we need to specify which types of events to check. Each key press is registered as a KEYDOWN event.</p>
<p><strong>Continuous movement</strong><br>We will let the game detect the pygame.KEYUP event so that we can know this when the player releases the right arrow key; then, we will combine the KEYDOWN and KEYUP events with a flag named moving_right to achieve continuous movement.</p>
<p><strong>Move left and right</strong></p>
<p><strong>Adjust the speed of the spacecraft</strong><br>You can add the property ship_speed_factor to the Settings class to control the speed of the spacecraft<br>By specifying the speed setting as a small value, you can control the speed of the spacecraft in more detail when speeding up the game later. However, attributes such as centerx of rect can only store integer values, so we need to make some modifications to the Ship class</p>
<p><strong>Limit the scope of movement of the spacecraft</strong><br><strong>Refactoring check_events()</strong></p>
<h5 id="6-Simple-summary"><a href="#6-Simple-summary" class="headerlink" title="6. Simple summary"></a>6. Simple summary</h5><p><strong>alien_invasion.py</strong><br> The main file alien_invasion.py creates a series of objects used throughout the game: the settings stored in ai_settings, the main display surface stored in the screen, and a spaceship instance. The file alien_invasion.py also contains the main loop of the game, which is a while loop that calls check_events(), ship.update(), and update_screen().<br>To play the game “Alien Invasion”, just run the file alien_invasion.py. The codes contained in other files (settings.py, game_functions.py, ship.py) are directly or indirectly imported into this file.</p>
<p><strong>settings.py</strong><br> The file settings.py contains the Settings class. This class only contains the method <strong>init</strong>(), which initializes the properties that control the appearance of the game and the speed of the spacecraft.</p>
<p><strong>game_functions.py</strong><br> The file game_functions.py contains a series of functions, most of the work of the game is done by them. The function check_events() detects related events, such as key-down and release, and uses auxiliary functions check_keydown_events() and check_keyup_events() to handle these events. For now, these functions manage the movement of the spacecraft. The module game_functions also contains the function update_screen(), which is used to redraw the screen every time the main loop is executed.</p>
<p><strong>ship.py</strong><br> The file ship.py contains the Ship class, which contains the method <strong>init</strong>(), the update() method for managing the position of the spaceship, and the method blitme() for drawing the spaceship on the screen. Indicates that the image of the spacecraft is stored in the file ship.bmp under the folder images</p>
<h5 id="7-Shooting"><a href="#7-Shooting" class="headerlink" title="7. Shooting"></a>7. Shooting</h5><p><strong>Add Bullet Settings</strong><br>First, update settings.py to store the required values ​​for the new class Bullet at the end of its method <strong>init</strong>()</p>
<p><strong>Create Bullet class</strong></p>
<p><strong>Store bullets in groups</strong><br>After defining the Bullet class and the necessary settings, you can write code to shoot a bullet every time the player presses the space bar. First, we will create a group in alien_invasion.py to store all valid bullets so that we can manage all the bullets that are fired.</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
    </footer>
  </div>

   
   
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">next page</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2017-2020
        <i class="ri-heart-fill heart_icon"></i> Hanqi ZHOU
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Hanqi ZHOU"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">Home</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">Blog</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags/life">Life</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">About Me</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->

<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
  </div>
</body>

</html>